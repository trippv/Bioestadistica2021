<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Miguel Tripp" />

<meta name="date" content="2021-05-18" />

<title>Clase 6: Supuestos</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bioestadistica 2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/trippv/Bioestadistica2021">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Clase 6: Supuestos</h1>
<h4 class="author">Miguel Tripp</h4>
<h4 class="date">2021-05-18</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-06-16
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>2021/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210412code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210412)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210412code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210412)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomtrippvBioestadistica2021tree28f09a5533131abb488d73c498e591baad7d73edtargetblank28f09a5a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/trippv/Bioestadistica2021/tree/28f09a5533131abb488d73c498e591baad7d73ed" target="_blank">28f09a5</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomtrippvBioestadistica2021tree28f09a5533131abb488d73c498e591baad7d73edtargetblank28f09a5a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/trippv/Bioestadistica2021/tree/28f09a5533131abb488d73c498e591baad7d73ed" target="_blank">28f09a5</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  Curso_Bioestadistica_MTripp_cuatriII.docx
    Untracked:  Curso_Bioestadistica_MTripp_cuatriII.pdf
    Untracked:  Diapositivas/
    Untracked:  README.html
    Untracked:  Resources/
    Untracked:  analysis/Clase9_anova2vias.Rmd
    Untracked:  analysis/images/
    Untracked:  code/tarea_macrograd.R
    Untracked:  data/CS_subset.csv
    Untracked:  data/Consumo_oxigeno_wide.csv
    Untracked:  data/Darwin_esp.csv
    Untracked:  data/Data_enzimas_Experimento1.txt
    Untracked:  data/Data_enzimas_Experimento2.txt
    Untracked:  data/Data_enzimas_Experimento3.txt
    Untracked:  data/Data_enzimas_Experimento4.txt
    Untracked:  data/DownloadFestival(No Outlier).dat
    Untracked:  data/Festival.csv
    Untracked:  data/LungCapData.txt
    Untracked:  data/LungCapDataEsp.csv
    Untracked:  data/RExam.dat
    Untracked:  data/Rexamendat.csv
    Untracked:  data/Tabla1_Muestreo.txt
    Untracked:  data/Transcriptome_Anotacion.csv
    Untracked:  data/Transcriptome_DGE.csv
    Untracked:  data/Vinogradov_2004_Titanic.tab
    Untracked:  data/Vinogradov_2004_Titanic.tab.csv
    Untracked:  data/data_tukey.txt
    Untracked:  data/datasets_Pokemon.csv
    Untracked:  data/datasets_Pokemon.xls
    Untracked:  data/exp_macrogard_growth.tab
    Untracked:  data/exp_macrogard_rna-dna.tab
    Untracked:  data/macrogard_crecimiento.csv
    Untracked:  data/penguins_size.csv
    Untracked:  data/pokemon_extended.csv
    Untracked:  output/Plot_all_penguins.pdf
    Untracked:  output/Plot_all_penguins.tiff
    Untracked:  output/graficos/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Clase6_Supuestos.Rmd</code>) and HTML (<code>docs/Clase6_Supuestos.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/c5dfe6aa68a1601f875758a32c1ff9208d78f3e8/docs/Clase6_Supuestos.html" target="_blank">c5dfe6a</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-06-14
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/2352c47ae31b1714b80962224b8c0c6b4c212da1/docs/Clase6_Supuestos.html" target="_blank">2352c47</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-06-12
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/99c36447acbcd5a24027999ab24426a8ad2ce4e0/docs/Clase6_Supuestos.html" target="_blank">99c3644</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-06-05
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/fbd7857f5a9cf55d6546a2247dd2de761889b4af/docs/Clase6_Supuestos.html" target="_blank">fbd7857</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-06-05
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/87a646f0f99382cc3dd71a37665b3b42c2977675/docs/Clase6_Supuestos.html" target="_blank">87a646f</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-06-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/47a71474d287b7e473979ca0ec49cc4e7b28cc37/docs/Clase6_Supuestos.html" target="_blank">47a7147</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-31
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/trippv/Bioestadistica2021/blob/3b990327f8342145d63c6c41ee3230763b2f941f/analysis/Clase6_Supuestos.Rmd" target="_blank">3b99032</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-31
</td>
<td>
Publish the initial files for myproject
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/95c661f0de4c8358e2c8122680fb73ea8d8612a7/docs/Clase6_Supuestos.html" target="_blank">95c661f</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-31
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/trippv/Bioestadistica2021/blob/d2189e14b85cbcbb7e4492bce62ce1abc085b7db/analysis/Clase6_Supuestos.Rmd" target="_blank">d2189e1</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-31
</td>
<td>
Publish the initial files for myproject
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/34660dee6ce175fda7ed3d94a4ab1a94a53de330/docs/Clase6_Supuestos.html" target="_blank">34660de</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-24
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/trippv/Bioestadistica2021/blob/458bf8fb53f19b14c11d00af8ec0492c80478cf2/analysis/Clase6_Supuestos.Rmd" target="_blank">458bf8f</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-24
</td>
<td>
Publish the initial files for myproject
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/da04854bc9fd56374352c0be63851caeecf23d51/docs/Clase6_Supuestos.html" target="_blank">da04854</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-24
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/trippv/Bioestadistica2021/3321935893046310778d4aa798117c5d525f8bdb/docs/Clase6_Supuestos.html" target="_blank">3321935</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-24
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/trippv/Bioestadistica2021/blob/4233f46e078143d737d6979c48a8163a4f8315f3/analysis/Clase6_Supuestos.Rmd" target="_blank">4233f46</a>
</td>
<td>
Miguel Tripp
</td>
<td>
2021-05-24
</td>
<td>
Publish the initial files for myproject
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Muchos de los estadisticos que se abordan en el curso son pruebas paramétricas las cuales se basan en una distribución normal, es decir, que las muestras se hayan obtenido de una población distribución normal (Gausiana), por lo tanto, resulta de imortancía confirmar dicho supuesto antes de decidir que prueba estadistica es apropiada.</p>
<p>La mayoria de las pruebas paramétricas basadas en la distribución normal tienen cuatro supuestos que deben de cumplirse para que la prueba sea precisa:</p>
<ul>
<li><strong>Datos distribuidos normalmente:</strong> La interpretación de la mayoria de la pruebas estadisticas requiere del supuesto de que los datos fueron colectados de una población que sigue una distribución normal simetrica en el centro (la media).</li>
</ul>
<div class="figure" style="text-align: center">
<img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-2-1.png" alt="Figura: WikiCommons" width="672" />
<p class="caption">
Figura: WikiCommons
</p>
</div>
<ul>
<li><strong>Homogeneidad de varianzas:</strong> El supuesto de homogeneidad de varianzas, también conocido como supuesto de homocedasticidad, implica que las varianzas deben de ser iguales en los datos. En diseños que implican una prueba entre varios grupos o tratamientos, este supuesto implica que cada uno de estos grupos viene de una población con la misma varianza. En diseños de correlación, este supuesto implica que la varianza de una variable debe mantenerse estable en todos los niveles de la otra variable</li>
</ul>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Independencia de los datos:</strong> Este supuesto va a depender del tipo de análisis que vayamos a realizar. En ciertos casos, este supuesto implica que las observaciones de cada individuo de un grupo experimental no afecta las observaciones de los otros individuos</li>
</ul>
</div>
<div id="comprobar-la-normalidad-de-los-datos" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Comprobar la normalidad de los datos</h1>
<div id="histogramas-y-distribución-normal" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Histogramas y distribución normal</h2>
<p>Con una cantidad de datos de la muestra suficientemente grande (n&gt;30) la violación del supuesto de la normalidad no debería causar mayores problemas. Esto implica que podemos ignorar la distribución de los datos y usar pruebas paramétricas si estamos tratando con muestras de gran tamaño.</p>
<p>El teorema del límite central nos dice que sin importar el tipo de distribución que tengan las cosas, la distribución de la muestra tiende a ser normal si ésta es lo suficientemente grande (n&gt;30).</p>
<p>Una de las formas en que podemos visualizar la distribución de los datos es mediante la generación de histogramas de frecuencia.</p>
<p>El histograma y el gráfico de densidad son herramientas muy útiles porque sirven para mostrar la distribución, la simetría, el sesgo, variabilidad, moda, mediana y observaciones atípicas de un conjunto de datos. Para explorar la normalidad de un conjunto de datos lo que se busca es que el histograma o gráfico de densidad presenten un patrón más o menos simétrico.</p>
<div id="asimetría-y-curtosis" class="section level3" number="2.1.1">
<h3 number="2.1.1"><span class="header-section-number">2.1.1</span> Asimetría y curtosis</h3>
<ul>
<li>La asimetría es el grado en que los datos no son simétricos. El hecho de que el valor de la asimetría sea 0, positivo o negativo, revela información sobre la forma de los datos. *A medida que los datos se vuelven más simétricos, el valor de su asimetría se acerca a cero. A medida que los valores se alejen del cero, es mas factible que los datos no tengan una distribución normal.</li>
<li>Valores <strong>positivos</strong> de asimetria indican que hay muchos valores bajos en la distribución, mientras que una asimetria <strong>negativa</strong> indican que hay un exceso de valores altos</li>
</ul>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;" /></p>
<pre><code>null device 
          1 </code></pre>
<ul>
<li>La curtosis indica la manera en que las colas de una distribución difieren de la distribución normal.</li>
<li>Los datos que siguen una distribución normal perfectamente tienen un <strong>valor de curtosis de 0</strong>. Los datos distribuidos normalmente establecen la línea de base para la curtosis. Una curtosis de la muestra que se desvía significativamente de 0 puede indicar que los datos no están distribuidos normalmente.</li>
<li>Una distribución con un valor positivo de curtosis indica que la distribución tiene colas más pesadas que la distribución normal.</li>
<li>Una distribución con un valor negativo de curtosis indica que la distribución tiene colas más livianas que la distribución normal</li>
</ul>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="las-distribuciones-normales-no-siempre-lucen-normales" class="section level3" number="2.1.2">
<h3 number="2.1.2"><span class="header-section-number">2.1.2</span> Las distribuciones normales no siempre lucen normales</h3>
<p>Las siguientes gráficas muestran la distribución de frecuencias de valores esogidos al asar de una distribución normal con una media = 36.77 y una desviación estandar de 0.40. La variación entre gráfico y gráfico es simplemente el resultado de la variación aleatoria durante el muestreo.</p>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="gráficos-cuantil-cuantil-q-q-plot" class="section level3" number="2.1.3">
<h3 number="2.1.3"><span class="header-section-number">2.1.3</span> Gráficos Cuantil-Cuantil (Q-Q plot)</h3>
<ul>
<li>Un gráfico Cuantil-Cuantil permite observar cuan cerca está la distribución de un conjunto de datos a alguna distribución ideal ó comparar la distribución de dos conjuntos de datos.</li>
<li>Los diagramas cuantil-cuantil normales se construyen trazando los <a href="https://es.wikipedia.org/wiki/Cuantil">cuantiles</a> de una variable numérica respecto de los cuantiles de una distribución normal. Esto significa que cada valor es comaparado con valor esperado si siguiera una distribucón normal.</li>
<li>Si las distribuciones de los cuantiles comparados son idénticas, los puntos del diagrama formarán una línea recta de 45 grados. Cuanto más lejos se desvíen los puntos del diagrama de una línea recta, menos similares serán las distribuciones comparadas.</li>
</ul>
<p><strong>Generar un gráfico Q-Q con R base</strong></p>
<pre class="r"><code>set.seed(123)

datos_norm &lt;- rnorm(n = 100, mean = 0, sd = 1)

hist(datos_norm, breaks = 12)</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>qqnorm(datos_norm)
qqline(datos_norm)</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Con ggplot</strong></p>
<pre class="r"><code>ggplot()+
  geom_histogram(aes(datos_norm), col = &quot;grey75&quot;, fill = &quot;white&quot;, bins = 12)</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot()+
  geom_qq(aes(sample = datos_norm))+
  geom_qq_line(aes(sample = datos_norm))</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Los gráficos Q-Q tambien nos permiten inspeccionar la distribución de los datos. Los datos que muestren una asimetria positiva o negativa tambien se veran reflejados en la desviación de los puntos de los valores obsverados con respecto a la distribución teórica.</p>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;" /></p>
<pre><code>null device 
          1 </code></pre>
<blockquote>
<p><strong>¿Por qué la distribución normal es central en la teoría estadistca?</strong> La distribución normal o Gaussiana juega un papel central en la estadística debido a la relación matemática conocida como el <em>teorema del límite central</em>. Este dice que si tu muestra es lo suficientemente grande, la distribución de las medias se aproximará a la distribución Gaussiana, aún si la población no es Gaussiana. Debido a que la mayoria de las pruebas estadisticas (como la t de Student o el análisis de varianzas) se centran solamente en las diferencias entre las medias, la teoría del limite central explica porque estas pruebas funcionan aún cuando la población no es Gaussiana.</p>
</blockquote>
</div>
</div>
</div>
<div id="evaluando-la-normalidad" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Evaluando la normalidad</h1>
<p>Para evaluar el supuesto de normalidad, vamos a usar un set de datos obtenidos de un festival de música en el Reino Unido, en el cual se evaluó la higiene de los participantes durante los tres dias del festival utilizando una técnica estandarizada con un valor entre 4 (huele a rosas durante el rocio de la mañana) y 0 (huele a cuerpo putrefacto escondido en el traseso de un zorillo)(Andy Field)</p>
<pre class="r"><code>festival_url &lt;- &quot;https://raw.githubusercontent.com/trippv/Miguel_Tripp/master/Festival.csv&quot;

festival &lt;- read_csv(festival_url)

head(festival)</code></pre>
<pre><code># A tibble: 6 x 5
  numero genero  dia1  dia2  dia3
   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1   2111 Hombre  2.64  1.35  1.61
2   2229 Mujer   0.97  1.41  0.29
3   2338 Hombre  0.84 NA    NA   
4   2384 Mujer   3.03 NA    NA   
5   2401 Mujer   0.88  0.08 NA   
6   2405 Hombre  0.85 NA    NA   </code></pre>
<p>Dibujamos el histograma con los valores de densidad</p>
<pre class="r"><code>d1 &lt;- ggplot(data = festival, aes(x = dia1))+
  geom_histogram(aes(y = ..density..), color = &quot;black&quot;, fill = &quot;white&quot;)+
  labs(x = &quot;valores de higiene en dia 1&quot;, y = &quot;Densidad&quot;)+
  stat_function(fun = dnorm, args = list(mean = mean(festival$dia1, na.rm = TRUE),
                                                                 sd = sd(festival$dia1, na.rm = TRUE)
                                                     ))
d1</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /> La figura sugiere que los datos siguen una distribución normal. Ahora si gráficamos un QQplot</p>
<pre class="r"><code>d1_qq &lt;- ggplot(data = festival, aes(sample = dia1))+
  geom_qq()+
  geom_qq_line()

d1_qq</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Los datos se ajustan bastante a la diagonal.</p>
<p>Para explorar mas a fondo la distribución de los datos, es posible utilizar la funcion <code>describe()</code> dentro del paquete <em>psych</em> o la función <code>stat.desc()</code> del paquete <em>pastecs</em>.</p>
<blockquote>
<p>recuerda que para instalar un paquete debes usar la función <code>install.package()</code></p>
</blockquote>
<pre class="r"><code>psych::describe(festival$dia1)</code></pre>
<pre><code>   vars   n mean   sd median trimmed mad  min  max range skew kurtosis   se
X1    1 810 1.77 0.69   1.79    1.77 0.7 0.02 3.69  3.67    0    -0.42 0.02</code></pre>
<p>alternativamente:</p>
<pre class="r"><code>#indicamos norm = T para desplegar estadisticos de normalidad
pastecs::stat.desc(festival$dia1, basic = FALSE, norm = TRUE)  %&gt;% 
  round(3)</code></pre>
<pre><code>      median         mean      SE.mean CI.mean.0.95          var      std.dev 
       1.790        1.771        0.024        0.048        0.481        0.694 
    coef.var     skewness     skew.2SE     kurtosis     kurt.2SE   normtest.W 
       0.392       -0.004       -0.026       -0.422       -1.228        0.996 
  normtest.p 
       0.032 </code></pre>
<blockquote>
<p>Ejercicio 1: Usando ggplot y patchwork grafica el histograma de frecuencia con la distribución normal y los qqplots para cada unos de los dias del festival. Incluye el análisis con <em>pastecs</em> para cada grupo</p>
</blockquote>
<pre class="r fold-hide"><code>library(patchwork)

#1. definir los histogramas
d1 &lt;- ggplot(data = festival, aes(x = dia1))+
  geom_histogram(aes(y = ..density..), color = &quot;black&quot;, fill = &quot;white&quot;)+
  labs(x = &quot;valores de higiene en dia 1&quot;, y = &quot;Densidad&quot;)+
  stat_function(fun = dnorm, args = list(mean = mean(festival$dia1, na.rm = TRUE),
                                                                 sd = sd(festival$dia1, na.rm = TRUE)
                                                     ))

d2 &lt;- ggplot(data = festival, aes(x = dia2))+
  geom_histogram(aes(y = ..density..), color = &quot;black&quot;, fill = &quot;white&quot;)+
  labs(x = &quot;valores de higiene en dia 2&quot;, y = &quot;Densidad&quot;)+
  stat_function(fun = dnorm, args = list(mean = mean(festival$dia3, na.rm = TRUE),
                                                                 sd = sd(festival$dia3, na.rm = TRUE)
                                                     ))


d3 &lt;- ggplot(data = festival, aes(x = dia3))+
  geom_histogram(aes(y = ..density..), color = &quot;black&quot;, fill = &quot;white&quot;)+
  labs(x = &quot;valores de higiene en dia 2&quot;, y = &quot;Densidad&quot;)+
  stat_function(fun = dnorm, args = list(mean = mean(festival$dia3, na.rm = TRUE),
                                                                 sd = sd(festival$dia3, na.rm = TRUE)
                                                                                             ))

# definir los qq 
d2_qq &lt;- ggplot(data = festival, aes(sample = dia2))+
  geom_qq()+
  geom_qq_line()

d3_qq &lt;- ggplot(data = festival, aes(sample = dia3))+
  geom_qq()+
  geom_qq_line()


# combinar con pathchwor
(d1 + d1_qq) / (d2 + d2_qq) / (d3 + d3_qq)</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/ejercicio1-1.png" width="960" style="display: block; margin: auto;" /></p>
<pre class="r fold-hide"><code>pastec_res &lt;- pastecs::stat.desc(festival[, c(&quot;dia1&quot;, &quot;dia2&quot;,&quot;dia3&quot;)], basic = TRUE, norm = TRUE) %&gt;% 
  round(., 3)</code></pre>
<p>Los gráficos, asi como los valores de asimetría y curtosis sugieren que la higiene de los asistentes del festival se deteriora notablemente con el paso de los días.</p>
</div>
<div id="probando-la-distribución-normal" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Probando la distribución normal</h1>
<p>Otra forma de evaluar el supuesto de normalidad de los datos es mediante una prueba que nos indique si la distribución de los datos se desvia de una distribución normal.</p>
<div id="prueba-de-shapiro-wilk" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Prueba de Shapiro-Wilk</h2>
<p>Como el resto de tests que analizan la normalidad, se considera como hipótesis nula que <strong>los datos sí proceden de una distribución normal, la hipótesis alternativa que no lo hacen.</strong></p>
<p>El valor p de estos test indica la probabilidad de obtener una distribución como la observada si los datos realmente proceden de una población con una distribución normal.</p>
<p>Sin embargo, es importante tomar que cuenta que esta prueba tiene sus limitaciones, ya que con tamaños de muestra grandes es fácil tener valores singificativos de pequeñas desviaciones de la normalidad, por lo que una prueba significativa no necesariamente nos indica si la desviación de la normalidad es lo suficientemente grande como para sesgar los resultados de una prueba estadística.</p>
<p>La prueba de Shapiro-Wilk esta incluida dentro de los resultados de <code>stat.desc()</code> pero tambien es posible aplicarla usando la función <code>shapiro.test()</code></p>
<pre class="r"><code># Prueba shapiro dia1
shapiro.test(festival$dia1)</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  festival$dia1
W = 0.99592, p-value = 0.03198</code></pre>
<pre class="r"><code># Prueba shapiro dia2
shapiro.test(festival$dia2)</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  festival$dia2
W = 0.90832, p-value = 1.282e-11</code></pre>
<pre class="r"><code># Prueba shapiro dia3
shapiro.test(festival$dia3)</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  festival$dia3
W = 0.90775, p-value = 3.804e-07</code></pre>
</div>
<div id="prueba-de-kolmogorov-smirnov" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Prueba de Kolmogorov-Smirnov</h2>
<p>Este test se emplea para contrastar normalidad cuando el tamaño de la muestra es relativamente grande (&gt;50 [30]).</p>
<p>Es importante cnsiderar que la prueba de Kolmogorov-Smirnov <strong>asume que se conocen la media y varianza poblacional</strong>, lo que en la mayoría de los casos no es posible. Esto hace que el test sea muy conservador y poco potente. Para solventar este problema se desarrolló una modificación del Kolmogorov-Smirnov conocida como test Lilliefors. El test Lilliefors asume que la media y varianza son desconocidas, estando especialmente desarrollado para testar la normalidad.</p>
<pre class="r"><code>ks.test(festival$dia1, y = &quot;pnorm&quot;, mean=mean(festival$dia1), sd=sd(festival$dia1))</code></pre>
<pre><code>Warning in ks.test(festival$dia1, y = &quot;pnorm&quot;, mean = mean(festival$dia1), :
ties should not be present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>
    One-sample Kolmogorov-Smirnov test

data:  festival$dia1
D = 0.029298, p-value = 0.4902
alternative hypothesis: two-sided</code></pre>
<p>Para poder usar la prueba de Lilliefors es necesario instalar el paquete <code>nortest</code></p>
<pre class="r"><code>#install.packages(&quot;nortest&quot;)
nortest::lillie.test(festival$dia1)</code></pre>
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  festival$dia1
D = 0.029298, p-value = 0.09694</code></pre>
</div>
</div>
<div id="homogeneidad-de-varianzas-homocedasticidad" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Homogeneidad de varianzas (Homocedasticidad)</h1>
<p>El supuesto de homogeneidad de varianzas, también conocido como supuesto de homocedasticidad, considera que la varianza es constante (no varía) en los diferentes niveles de un factor, es decir, entre diferentes grupos.</p>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Existen diferentes test que permiten evaluar la distribución de la varianza. Todos ellos consideran como hipótesis nula que la varianza es igual entre los grupos y como hipótesis alternativa que no lo es. La diferencia entre ellos es el estadístico de centralidad que utilizan.</p>
<div id="prueba-de-levene" class="section level3" number="5.0.1">
<h3 number="5.0.1"><span class="header-section-number">5.0.1</span> Prueba de Levene</h3>
<p>La prueba de Levene es una prueba simple que trabaja realizando una ANOVA de una via sobre los valores de desvicación; es decir, la diferecia absoluta entre cada valor y la media del grupo del que viene.</p>
<p>Para utilizar esta prueba es necesario instalar el paquete <code>car</code> y usar la funcion <code>leveneTest()</code></p>
<p>La prueba LeveneTest se caracteriza ademas por permitir elegir entre diferentes estadísticos de centralidad :mediana (por defecto), media, media truncada. Esto es importante a la hora de contrastar la homocedasticidad dependiendo de si los grupos se distribuyen de forma normal o no.</p>
<blockquote>
<p>Nota: es importante considerar que necesitamos valores agrupados.</p>
</blockquote>
<p>Para este ejercicio, trabajaremos los datos <code>Rexamendat</code> los cuales contienen los resultados de un examen de R conducido en dos universidades</p>
<p>Aplicamos la prueba de Levene sobre los valores del examen y aritmetica (numeracy)</p>
<pre class="r"><code>Rexam_url &lt;- &quot;https://raw.githubusercontent.com/trippv/Miguel_Tripp/master/Rexamendat.csv&quot;
Rexam &lt;- read_csv(Rexam_url)</code></pre>
<pre><code>
-- Column specification --------------------------------------------------------
cols(
  examen = col_double(),
  habilidades = col_double(),
  lectura = col_double(),
  aritmetica = col_double(),
  uni = col_character()
)</code></pre>
<pre class="r"><code>#convertir la uni a factor
Rexam$uni &lt;- as.factor(Rexam$uni)

# graficas

ggplot(Rexam, aes(x = examen))+
  geom_histogram(col = &quot;grey65&quot;, fill = &quot;white&quot;)+
  labs(title = &quot;histograma de frecuencia para examen de R por universidad&quot;)+
  facet_grid(uni ~ .)</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>shapiro.test(Rexam$examen[Rexam$uni == &quot;Universidad Duncetown&quot;])</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  Rexam$examen[Rexam$uni == &quot;Universidad Duncetown&quot;]
W = 0.97217, p-value = 0.2829</code></pre>
<pre class="r"><code>ggplot(Rexam, aes(x = aritmetica))+
  geom_histogram(col = &quot;grey65&quot;, fill = &quot;white&quot;)+
  labs(title = &quot;histograma de frecuencia para examen de aritmentica por universidad&quot;)+
  facet_grid(uni ~ .)</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/Clase6_Supuestos.Rmd/unnamed-chunk-20-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>shapiro.test(Rexam$examen[Rexam$uni == &quot;Universidad Sussex&quot;])</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  Rexam$examen[Rexam$uni == &quot;Universidad Sussex&quot;]
W = 0.98371, p-value = 0.7151</code></pre>
<p>Para realizar la prueba de Levene ejecutamos la función <code>leveneTest()</code></p>
<pre class="r"><code>car::leveneTest(Rexam$examen, Rexam$uni)</code></pre>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.0886 0.1516
      98               </code></pre>
<pre class="r"><code>#alternativamente se puede ejecutar de la forma
car::leveneTest(Rexam$examen ~ Rexam$uni)</code></pre>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.0886 0.1516
      98               </code></pre>
<pre class="r"><code>car::leveneTest(Rexam$aritmetica, Rexam$uni)</code></pre>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  1   5.366 0.02262 *
      98                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Los resultados de la prueba se denotan con la letra <em>F</em> y en este caso hay dos tipos de grados de libertad (grupo y total). Por tanto se puede expresar en la forma <em>F(gl1, gl2)</em> = valor.</p>
<p>De manera que podemos decir que para los resultados de la prueba de R, las varianzas fueron similares en ambas universidades con <em>F(1,98) = 2.09; P &gt; 0.05</em> pero para los resultados de aritmentica, las varianzas fueron significativamente diferentes entre los grupos <em>F(1,98) = 5.37; P = 0.023</em></p>
</div>
<div id="prueba-f-razón-de-varianzas" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Prueba F (razón de varianzas)</h2>
<p>Es muy potente, detecta diferencias muy sutiles, pero <strong>es muy sensible a violaciones de la normalidad</strong> de las poblaciones. Por esta razón, no es un test recomendable si no se tiene mucha certeza de que las poblaciones se distribuyen de forma normal.</p>
<p>El F-test estudia el cociente de varianzas <span class="math inline">\(\sigma_2^{2} / \sigma_1^{2}\)</span>, que en caso de que sean iguales, toma el valor 1.</p>
<p>Dentro de R, esta prueba se ejecuta con la función <code>var.test()</code></p>
<pre class="r"><code># Prueba de varianzas para examen R
var.test(Rexam$examen ~ Rexam$uni)</code></pre>
<pre><code>
    F test to compare two variances

data:  Rexam$examen by Rexam$uni
F = 1.5217, num df = 49, denom df = 49, p-value = 0.1452
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.863548 2.681583
sample estimates:
ratio of variances 
          1.521734 </code></pre>
<pre class="r"><code># Prueba de varianzas para aritmentica
var.test(Rexam$aritmetica ~ Rexam$uni)</code></pre>
<pre><code>
    F test to compare two variances

data:  Rexam$aritmetica by Rexam$uni
F = 0.45281, num df = 49, denom df = 49, p-value = 0.006446
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.2569592 0.7979376
sample estimates:
ratio of variances 
         0.4528106 </code></pre>
<div id="prueba-de-bartlett" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Prueba de Bartlett</h3>
<p>Permite contrastar la igualdad de varianza en 2 o más poblaciones sin necesidad de que el tamaño de los grupos sea el mismo. <strong>Es más sensible que el test de Levene a la falta de normalidad</strong>, pero si se está seguro de que los datos provienen de una distribución normal, es la mejor opción.Se ejecuta con la función <code>bartlett.test()</code></p>
<pre class="r"><code>#Prueba para examen R
bartlett.test(Rexam$examen ~ Rexam$uni)</code></pre>
<pre><code>
    Bartlett test of homogeneity of variances

data:  Rexam$examen by Rexam$uni
Bartlett&#39;s K-squared = 2.122, df = 1, p-value = 0.1452</code></pre>
<pre class="r"><code>#Prueba para aritmética
bartlett.test(Rexam$aritmetica ~ Rexam$uni)</code></pre>
<pre><code>
    Bartlett test of homogeneity of variances

data:  Rexam$aritmetica by Rexam$uni
Bartlett&#39;s K-squared = 7.4206, df = 1, p-value = 0.006448</code></pre>
</div>
<div id="test-de-fligner-killeen" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Test de Fligner-Killeen</h3>
<p>Se trata de un test no paramétrico que compara las varianzas basándose en la mediana. Es también una alternativa cuando no se cumple la condición de normalidad en las muestras.</p>
<p>Se ejecuta con la función <code>fligner.test()</code></p>
<pre class="r"><code>#Prueba para examen R
fligner.test(Rexam$examen ~ Rexam$uni)</code></pre>
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  Rexam$examen by Rexam$uni
Fligner-Killeen:med chi-squared = 2.1791, df = 1, p-value = 0.1399</code></pre>
<pre class="r"><code>#Prueba para aritmética
fligner.test(Rexam$aritmetica ~ Rexam$uni)</code></pre>
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  Rexam$aritmetica by Rexam$uni
Fligner-Killeen:med chi-squared = 4.8469, df = 1, p-value = 0.0277</code></pre>
<blockquote>
<p>En conclusión: Si se tiene seguridad de que las muestras a comparar proceden de poblaciones que siguen una distribución normal, son recomendables el F-test y el test de Bartlet, pareciendo ser el segundo más recomendable ya que el primero es muy potente pero extremadamente sensible a desviaciones de la normal. Si no se tiene la seguridad de que las poblaciones de origen son normales, se recomiendan el test de Leven utilizando la mediana o el test no paramétrico Fligner-Killeen que también se basa en la mediana.</p>
</blockquote>
</div>
</div>
</div>
<div id="pruebas-de-supuestos-con-rstatixs" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Pruebas de supuestos con <code>rstatixs()</code></h1>
<p>rstatixs es un aquete que permite realizar las pruebas de normalizadad y varianza en un formato <em>pipe-friendly</em></p>
<pre class="r"><code>library(rstatix)</code></pre>
<pre><code>
Attaching package: &#39;rstatix&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    filter</code></pre>
<pre class="r"><code># Obtner el resumen de una variable o variables
Rexam %&gt;% 
  group_by(uni) %&gt;% 
  get_summary_stats(examen, type = &quot;common&quot;)</code></pre>
<pre><code># A tibble: 2 x 11
  uni            variable     n   min   max median   iqr  mean    sd    se    ci
  &lt;fct&gt;          &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Universidad D~ examen      50    15    66     38  16.5  40.2  12.6  1.78  3.58
2 Universidad S~ examen      50    56    99     75  12    76.0  10.2  1.44  2.9 </code></pre>
<pre class="r"><code># Prueba de shapiro de una variable
Rexam %&gt;% 
  shapiro_test(examen)</code></pre>
<pre><code># A tibble: 1 x 3
  variable statistic       p
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
1 examen       0.961 0.00499</code></pre>
<pre class="r"><code># Prueba de Shapiro por grupo
Rexam %&gt;% 
  group_by(uni) %&gt;% 
  shapiro_test(examen)</code></pre>
<pre><code># A tibble: 2 x 4
  uni                   variable statistic     p
  &lt;fct&gt;                 &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
1 Universidad Duncetown examen       0.972 0.283
2 Universidad Sussex    examen       0.984 0.715</code></pre>
<pre class="r"><code># Prueba de Levene por grupo

Rexam %&gt;% 
  levene_test(examen ~ uni)</code></pre>
<pre><code># A tibble: 1 x 4
    df1   df2 statistic     p
  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
1     1    98      2.09 0.152</code></pre>
<blockquote>
<p>Ejercicio 2: Utiliza la base de datos de pingüinos, evalua si los valores de la longitud de la aleta <em>(flipper_length_mm)</em> entre cada especie cumplen los supuestos normalidad y homogeneidad de varianzas. Utiliza métodos gráficos y pruebas estadísticas</p>
</blockquote>
<pre class="r fold-hide"><code>penguins &lt;- read_csv(&quot;data/penguins_size.csv&quot;)

penguins &lt;- penguins %&gt;% 
  select(species, island, flipper_length_mm) %&gt;% 
  filter(complete.cases(flipper_length_mm))

ggplot(penguins, aes(x = flipper_length_mm)) +
  geom_histogram()+
 facet_wrap(~species)


ggplot(penguins, aes(sample = flipper_length_mm)) +
  geom_qq()+
  geom_qq_line()+
  facet_wrap(~species)


# Prueba de normalidad

# Todo el set
penguins %&gt;% 
  shapiro_test(flipper_length_mm)

# Por especie
penguins %&gt;% 
  group_by(species) %&gt;% 
  shapiro_test(flipper_length_mm)



# Prueba de homogeneidad de varianzas

penguins %&gt;% 
  levene_test(flipper_length_mm ~ species)


# Visualización por medio de boxlot

p1 &lt;- penguins %&gt;% 
  ggplot(., aes(x = species, y = flipper_length_mm, color = species))+
  geom_point(position = position_jitter(width = 0.2))+
  geom_boxplot(alpha = 0.4)+
  theme(legend.position = &quot;none&quot;)


p2 &lt;- penguins %&gt;% 
  ggplot(., aes(x = flipper_length_mm, fill = species))+
  geom_density(alpha = 0.4)+
  coord_flip()+
  theme(legend.position = &quot;none&quot;,
        axis.title.y = element_blank(),
        axis.text.y = element_blank())
  

library(patchwork)

p1 + p2 + plot_layout(ncol = 2, widths = c(4,1))</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.5 (2021-03-31)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19041)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] rstatix_0.7.0   patchwork_1.1.1 forcats_0.5.1   stringr_1.4.0  
 [5] dplyr_1.0.5     purrr_0.3.4     readr_1.4.0     tidyr_1.1.3    
 [9] tibble_3.0.4    ggplot2_3.3.3   tidyverse_1.3.1 workflowr_1.6.2

loaded via a namespace (and not attached):
 [1] nlme_3.1-152      fs_1.5.0          lubridate_1.7.10  httr_1.4.2       
 [5] rprojroot_2.0.2   tools_4.0.5       backports_1.2.1   utf8_1.2.1       
 [9] R6_2.5.0          nortest_1.0-4     DBI_1.1.0         colorspace_2.0-0 
[13] withr_2.4.2       tidyselect_1.1.1  mnormt_2.0.2      curl_4.3         
[17] compiler_4.0.5    git2r_0.27.1      cli_2.5.0         rvest_1.0.0      
[21] pastecs_1.3.21    xml2_1.3.2        labeling_0.4.2    scales_1.1.1     
[25] psych_2.0.12      digest_0.6.27     foreign_0.8-81    rmarkdown_2.6    
[29] rio_0.5.16        pkgconfig_2.0.3   htmltools_0.5.1.1 dbplyr_2.1.1     
[33] highr_0.8         rlang_0.4.11      readxl_1.3.1      rstudioapi_0.13  
[37] farver_2.0.3      generics_0.1.0    jsonlite_1.7.2    zip_2.1.1        
[41] car_3.0-10        magrittr_2.0.1    Rcpp_1.0.5        munsell_0.5.0    
[45] fansi_0.4.2       abind_1.4-5       lifecycle_1.0.0   stringi_1.5.3    
[49] whisker_0.4       yaml_2.2.1        carData_3.0-4     grid_4.0.5       
[53] parallel_4.0.5    promises_1.1.1    crayon_1.4.1      lattice_0.20-41  
[57] haven_2.3.1       hms_1.0.0         tmvnsim_1.0-2     knitr_1.30       
[61] ps_1.5.0          pillar_1.6.0      boot_1.3-27       reprex_2.0.0     
[65] glue_1.4.2        evaluate_0.14     data.table_1.13.6 modelr_0.1.8     
[69] vctrs_0.3.8       httpuv_1.5.4      cellranger_1.1.0  gtable_0.3.0     
[73] assertthat_0.2.1  xfun_0.23         openxlsx_4.2.3    broom_0.7.6      
[77] later_1.1.0.1     ellipsis_0.3.1   </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
